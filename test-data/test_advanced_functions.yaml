_forge_version: "5.0.0"

# Advanced function tests for coverage

inputs:
  rate:
    value: 0.05
  periods:
    value: 12
  principal:
    value: 10000
  start_date:
    value: "2025-01-15"
  months_to_add:
    value: 3

outputs:
  # Financial functions
  pv_result:
    formula: "=PV(rate / 12, periods, -1000)"
  fv_result:
    formula: "=FV(rate / 12, periods, -1000)"
  pmt_result:
    formula: "=PMT(rate / 12, periods, principal)"

  # Date functions
  date_result:
    formula: "=DATE(2025, 6, 15)"
  year_result:
    formula: "=YEAR(start_date)"
  month_result:
    formula: "=MONTH(start_date)"
  day_result:
    formula: "=DAY(start_date)"
  edate_result:
    formula: "=EDATE(start_date, months_to_add)"
  eomonth_result:
    formula: "=EOMONTH(start_date, 0)"

  # Math functions
  round_result:
    formula: "=ROUND(3.14159, 2)"
  roundup_result:
    formula: "=ROUNDUP(3.14159, 2)"
  rounddown_result:
    formula: "=ROUNDDOWN(3.14159, 2)"
  ceiling_result:
    formula: "=CEILING(3.14159, 0.5)"
  floor_result:
    formula: "=FLOOR(3.14159, 0.5)"
  mod_result:
    formula: "=MOD(17, 5)"
  sqrt_result:
    formula: "=SQRT(16)"
  power_result:
    formula: "=POWER(2, 10)"

# Table with lookup tests
lookup_data:
  id: [1, 2, 3, 4, 5]
  name: ["Alpha", "Beta", "Gamma", "Delta", "Epsilon"]
  value: [100, 200, 300, 400, 500]
  category: ["A", "B", "A", "B", "A"]

# Test conditional aggregation
category_totals:
  formula: "=SUMIF(lookup_data.category, \"A\", lookup_data.value)"

# Variance functions test
variance_data:
  actual: [100, 150, 200]
  budget: [120, 140, 180]
  variance:
    formula: "=VARIANCE(actual, budget)"
  variance_pct:
    formula: "=VARIANCE_PCT(actual, budget)"

# CHOOSE and SWITCH tests
selection_tests:
  index_val: [1, 2, 3, 1, 2]
  code: ["X", "Y", "Z", "X", "Y"]
  # Test formulas using CHOOSE - select from list by index
  choice_result:
    formula: "=CHOOSE(index_val, 10, 20, 30)"
  # Test SWITCH - match value and return result
  switch_result:
    formula: "=SWITCH(code, \"X\", 100, \"Y\", 200, \"Z\", 300, 0)"

# LET function tests
let_tests:
  base: [10, 20, 30]
  multiplier: [2, 3, 4]
  # LET with named variables
  let_result:
    formula: "=LET(x, base, y, multiplier, x * y)"
