# Test file for v0.2.0 formula functions
# Tests new Excel-compatible functions from xlformula_engine
# Note: xlformula_engine v0.1.18 has limitations - only basic functions tested here

# SUM function tests
sum_tests:
  val1:
    value: 10
    formula: null
  val2:
    value: 20
    formula: null
  val3:
    value: 30
    formula: null

  total:
    value: 60
    formula: "=SUM(val1, val2, val3)"

  # SUM with literals
  literal_sum:
    value: 15
    formula: "=SUM(5, 10)"

# AVERAGE function tests
average_tests:
  num1:
    value: 100
    formula: null
  num2:
    value: 200
    formula: null
  num3:
    value: 300
    formula: null

  mean:
    value: 200
    formula: "=AVERAGE(num1, num2, num3)"

# PRODUCT function tests
product_tests:
  factor1:
    value: 2
    formula: null
  factor2:
    value: 3
    formula: null
  factor3:
    value: 4
    formula: null

  result:
    value: 24
    formula: "=PRODUCT(factor1, factor2, factor3)"

# ABS function tests
abs_tests:
  negative:
    value: -100
    formula: null

  positive:
    value: 100
    formula: "=ABS(negative)"

# IF function tests (simple boolean values)
if_tests:
  condition_value:
    value: 1
    formula: null

  # Simple IF with literal condition
  simple_if:
    value: 10
    formula: "=IF(condition_value, 10, 20)"

# Combined operations
combined:
  q1:
    value: 100
    formula: null
  q2:
    value: 120
    formula: null
  q3:
    value: 150
    formula: null
  q4:
    value: 180
    formula: null

  annual:
    value: 550
    formula: "=SUM(q1, q2, q3, q4)"

  average:
    value: 137.5
    formula: "=AVERAGE(q1, q2, q3, q4)"

  product_of_averages:
    value: 75625
    formula: "=PRODUCT(annual, average)"

#  Note: Future enhancements for v0.3.0+
# - MAX and MIN functions (not in xlformula_engine)
# - AND, OR, NOT with comparisons (limited support)
# - SUMIF, COUNTIF, AVERAGEIF (conditional aggregation)
# - NPV, IRR, PMT (financial functions)
